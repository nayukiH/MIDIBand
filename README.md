# 《WPF实现MIDI乐队APP》实验报告

学院：智能与计算学部  班级： 三班    学号：3017218147    姓名：曾洋

日期：    2019年  4月  11日

## 一. 功能概述

1）使用MIDI Band成功播放MIDI文件，正常使用open, start, stop, continue等功能

2） 实现各控件大小随界面大小变化自动调整

3） 增加播放列表，支持单曲循环和列表循环

4） 在列表基础上支持上一首和下一首播放功能

5） 修改上下切换的按键图标，及其他外观调整

## 二. 项目特色

1） 支持MIDI单曲循环及列表循环

2） 支持上下切换歌曲

## 三. 代码总量

在原有代码基础上约增加80-90行

## 四. 工作时间

约四天

## 五. 结论

1） 添加文件到列表时，如果两次选择相同文件会抛出异常，所以先使用MIDIList.ContainsKey()检验是否存在；

2） 通过slider的变化来判断是否播放完毕，从而实现循环播放功能；

2） 上下切歌时，如果是单曲循环模式，则重新播放当前歌曲；

3） 最终界面效果如下：

![](C:\Users\nayuk\Pictures\工作\c#\midi3\界面1.JPG)

不足之处有几点，一是切歌按键的点击效果不太美观，二是添加歌曲时偶尔依旧存在死锁问题。另外，窗口大小变化时让控件随之变化，但简单拉伸导致失真变形，有待优化。